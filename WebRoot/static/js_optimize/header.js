$(function(){function A(){var B=$("#J_brand"),U=$("#J_classify"),O=$(".container"),G=O.find(".content"),H=O.find(".brand_submenubox"),K=O.find(".classify_submenubox"),C=O.find("#asideBrandBox"),Q=O.find("#asideClassifyBox"),N=O.find(".registrationWrap"),M=G.position().top,L=G.position().left,S=$("#tip"),I=0,P=0,J=0,R=0,F=0,D=0;H.css({top:M+60,left:L+36});K.css({top:M+60,left:L+36});function W(){if(J==1&&P==0){H.show();return }$.post("brand.do?action=list",{categoryId:P},function(Y){Y=$.parseJSON(Y);if(Y.result){var X=[];$.each(Y.result.map,function(Z,a){X[X.length]=Z});X.sort();$("#head_brand_ul").empty();$.each(X,function(Z,a){$("#head_brand_ul").append('<li><span class="sort_title">'+a+'</span><div class="detail" id=\'brand_li_'+a+"'></div></li>");$.each(Y.result.map[a].list,function(c,b){if(b.show){$("#brand_li_"+a).append('<a href="javascript:;" data-id="'+b.idBrd+'" class="nav_item">'+b.nameBrd+" </a>")}else{$("#brand_li_"+a).append('<span class="item_disabled">'+b.nameBrd+"</span>")}})});H.show();if(P==0){J=1}else{J=0}}else{}})}function V(){if(R==1&&I==0){K.show();return }$.post("category.do?action=list",{brandId:I},function(X){X=$.parseJSON(X);if(X.result){$("#head_category_ul").empty();$.each(X.result.list,function(Y,Z){if(Z.show){$("#head_category_ul").append('<li><a href="javascript:;" class="nav_item" data-id="'+Z.idCat+'">'+Z.nameCat+"</a></li>")}else{$("#head_category_ul").append('<li><span class="item_disabled">'+Z.nameCat+"</span></li>")}});K.show();if(I==0){R=1}else{R=0}}else{}})}O.on("click",".nav",function(){var X=$(this);O.find(".nav").removeClass("current");X.addClass("current");N.hide();if(X.attr("id")==="J_brand"){P=0;K.hide();W()}else{if(X.attr("id")==="J_classify"){I=0;H.hide();V()}else{K.hide();H.hide()}}});O.on("click",".nav_item",function(){var Y=$(this),X=Y.parents(".wrap");O.find(".nav").removeClass("current");if(X.hasClass("brand_submenubox")){I=Y.attr("data-id");if(P!=""&&I!=""){window.location.href="brand.do?action=detail&id="+I+"&categoryId="+P}else{X.hide();V();U.addClass("current")}}else{if(X.hasClass("classify_submenubox")){P=Y.attr("data-id");if(P!=""&&I!=""){window.location.href="brand.do?action=detail&id="+I+"&categoryId="+P}else{X.hide();W();B.addClass("current")}}}});O.on("click",".userBtn",function(){var X=$(this);N.css({top:M+60}).show()});O.on("click",".submit",function(){var a=$(".userName").val(),Y=$(".email").val(),b=$(".weiXin").val(),X=$(".password").val(),Z=$(".rePassword").val();S.hide();if(a==""||Y==""||b==""||X==""){S.html("请检查必填项").show();return }else{if(X!=Z){S.html("两次输入的密码不一致").show();return }}$.post("register.do",{username:a,email:Y,weixin:b,p:X,pc:Z},function(c){c=$.parseJSON(c);if(!!c.success){N.hide();window.location.reload()}else{S.html(c.message).show()}})});O.on("click",".login_btn",function(){var a=$(this),Y=$(".login_error"),Z=$("#j_username").val(),X=$("#j_password").val();Y.hide();if(Z==""){Y.html("请输入用户名").show();return }if(X==""){Y.html("请输入密码").show();return }$.post("login.do",{usernameOrEmail:Z,password:X,},function(b){b=$.parseJSON(b);if(!!b.success){N.hide();window.location.reload()}else{Y.html(b.message).show()}})});O.on("click",".item",function(){var Z=$(this),X=Z.parents(".aside_nav"),Y=X.attr("id");if(Y=="aside_nav_brand"){I=Z.attr("id");if(P!=""&&I!=""){window.location.href="brand.do?action=detail&id="+I+"&categoryId="+P}else{X.find(".classification").removeClass("current");X.siblings(".aside_nav").find(".classification").addClass("current");C.hide();T()}}if(Y=="aside_nav_classify"){P=Z.attr("id");if(P!=""&&I!=""){window.location.href="brand.do?action=detail&id="+I+"&categoryId="+P}else{X.find(".classification").removeClass("current");X.siblings(".aside_nav").find(".classification").addClass("current");Q.hide();E()}}});$("#aside_nav_brand").on({mouseenter:function(){var X=$(this);X.find(".classification").addClass("current");I=0;E()},mouseleave:function(){var X=$(this);X.find(".classification").removeClass("current");C.hide()}});$("#aside_nav_classify").on({mouseenter:function(){var X=$(this);X.find(".classification").addClass("current");P=0;T()},mouseleave:function(){var X=$(this);X.find(".classification").removeClass("current");Q.hide()}});function E(){if(F==1&&P==0){C.show();return }$.post("brand.do?action=list",{categoryId:P},function(Y){Y=$.parseJSON(Y);if(Y.result){var X=[];$.each(Y.result.map,function(Z,a){X[X.length]=Z});X.sort();$("#aside_brand_ul").empty();$.each(X,function(Z,a){$("#aside_brand_ul").append('<li><span class="sort_title">'+a+'</span><div class="detail" id=\'aside_brand_li_'+a+"'></div></li>");$.each(Y.result.map[a].list,function(c,b){if(b.show){$("#aside_brand_li_"+a).append('<a href="javascript:;" id="'+b.idBrd+'" class="item">'+b.nameBrd+" </a>")}else{$("#aside_brand_li_"+a).append('<span class="item_disabled">'+b.nameBrd+"</span>")}})});C.show();if(P==0){F=1}else{F=0}}else{}})}function T(){if(D==1&&I==0){Q.show();return }$.post("category.do?action=list",{brandId:I},function(X){X=$.parseJSON(X);if(X.result){$("#aside_category_ul").empty();$.each(X.result.list,function(Y,Z){if(Z.show){$("#aside_category_ul").append('<li><a href="javascript:;" class="item" id="'+Z.idCat+'">'+Z.nameCat+"</a></li>")}else{$("#aside_category_ul").append('<li><span class="item_disabled">'+Z.nameCat+"</span></li>")}});Q.show();if(I==0){D=1}else{D=0}}else{}})}}A()});