$(function(){function A(){var B=$("#J_brand"),Z=$("#J_classify"),S=$(".container"),G=S.find(".content"),I=S.find(".brand_submenubox"),M=S.find(".classify_submenubox"),C=S.find("#asideBrandBox"),U=S.find("#asideClassifyBox"),R=S.find(".registrationWrap"),Q=G.position().top,O=G.position().left,W=$("#tip"),K=0,T=0,L=0,V=0,F=0,D=0,H=0;I.css({top:Q+60,left:O+36});M.css({top:Q+60,left:O+36});function b(){H=1;if(L==1&&T==0){I.show();return }$.post("brand.do?action=list",{categoryId:T},function(d){d=$.parseJSON(d);if(d.result){var c=[];$.each(d.result.map,function(e,f){c[c.length]=e});c.sort();$("#head_brand_ul").empty();$.each(c,function(e,f){$("#head_brand_ul").append('<li><div class="sort_title">'+f+"</div><div id='brand_li_"+f+"'></div></li>");$.each(d.result.map[f].list,function(h,g){if(g.show){$("#brand_li_"+f).append('</br><a href="javascript:;" data-id="'+g.idBrd+'" class="nav_item">'+g.nameBrd+" </a>")}else{$("#brand_li_"+f).append('</br><span class="item_disabled">'+g.nameBrd+"</span>")}})});I.show();if(T==0){L=1}else{L=0}}else{}})}function a(){H=1;if(V==1&&K==0){M.show();return }$.post("category.do?action=list",{brandId:K},function(c){c=$.parseJSON(c);if(c.result){$("#head_category_ul").empty();$.each(c.result.list,function(d,e){if(e.show){$("#head_category_ul").append('<li><a href="javascript:;" class="nav_item" data-id="'+e.idCat+'">'+e.nameCat+"</a></li>")}else{$("#head_category_ul").append('<li><span class="item_disabled">'+e.nameCat+"</span></li>")}});M.show();if(K==0){V=1}else{V=0}}else{}})}S.on("click",".nav",function(){var c=$(this);S.find(".nav").removeClass("current");c.addClass("current");R.hide();if(c.attr("id")==="J_brand"){T=0;M.hide();b()}else{if(c.attr("id")==="J_classify"){K=0;I.hide();a()}else{M.hide();I.hide()}}});S.on("click",".nav_item",function(){var d=$(this),c=d.parents(".wrap");S.find(".nav").removeClass("current");if(c.hasClass("brand_submenubox")){K=d.attr("data-id");if(T!=""&&K!=""){window.location.href="brand.do?action=detail&id="+K+"&categoryId="+T}else{c.hide();a();Z.addClass("current")}}else{if(c.hasClass("classify_submenubox")){T=d.attr("data-id");if(T!=""&&K!=""){window.location.href="brand.do?action=detail&id="+K+"&categoryId="+T}else{c.hide();b();B.addClass("current")}}}});S.on("click",".userBtn",function(){var c=$(this);R.css({top:Q+60}).show()});S.on("click",".submit",function(){var g=$(".userName").val(),e=$(".email").val(),h=$(".weiXin").val(),d=$(".password").val(),f=$(".rePassword").val();W.hide();if(g==""||e==""||h==""||d==""){var i=$("#Register_Check")[0].value;W.html(i).show();return }else{if(d!=f){var c=$("#Register_Password_Not_Match")[0].value;W.html(c).show();return }}$.post("register.do",{username:g,email:e,weixin:h,p:d,pc:f},function(j){j=$.parseJSON(j);if(!!j.success){R.hide();var k=$("#Register_Success").val();alert(k);window.location.reload()}else{W.html(j.message).show()}})});S.on("click",".login_btn",function(){var g=$(this),e=$(".login_error"),f=$("#j_username").val(),c=$("#j_password").val();e.hide();if(f==""){var d=$("#Login_Enter_Username")[0].value;e.html(d).show();return }if(c==""){var h=$("#Login_Enter_Password")[0].value;e.html(h).show();return }$.post("login.do",{usernameOrEmail:f,password:c,},function(i){i=$.parseJSON(i);if(!!i.success){R.hide();window.location.reload()}else{e.html(i.message).show()}})});S.on("click",".item",function(){var e=$(this),c=e.parents(".aside_nav"),d=c.attr("id");if(d=="aside_nav_brand"){K=e.attr("id");if(T!=""&&K!=""){window.location.href="brand.do?action=detail&id="+K+"&categoryId="+T}else{c.find(".classification").removeClass("current");c.siblings(".aside_nav").find(".classification").addClass("current");C.hide();X()}}if(d=="aside_nav_classify"){T=e.attr("id");if(T!=""&&K!=""){window.location.href="brand.do?action=detail&id="+K+"&categoryId="+T}else{c.find(".classification").removeClass("current");c.siblings(".aside_nav").find(".classification").addClass("current");U.hide();E()}}});function P(){$("#aside_nav_brand").find(".classification").addClass("current");K=0;E()}function Y(){$("#aside_nav_brand").find(".classification").removeClass("current");C.hide()}function J(){$("#aside_nav_classify").find(".classification").addClass("current");T=0;X()}function N(){$("#aside_nav_classify").find(".classification").removeClass("current");U.hide()}$("#aside_nav_brand").on({mouseenter:function(){if(H==1){return }N();P()},mouseleave:function(){Y()}});$("#aside_nav_classify").on({mouseenter:function(){if(H==1){return }Y();J()},mouseleave:function(){N()}});function E(){if(F==1&&T==0){C.show();return }$.post("brand.do?action=list",{categoryId:T},function(d){d=$.parseJSON(d);if(d.result){var c=[];$.each(d.result.map,function(e,f){c[c.length]=e});c.sort();$("#aside_brand_ul").empty();$.each(c,function(e,f){$("#aside_brand_ul").append('<li><span class="sort_title">'+f+"</span><div id='aside_brand_li_"+f+"'></div></li>");$.each(d.result.map[f].list,function(h,g){if(g.show){$("#aside_brand_li_"+f).append('</br><a href="javascript:;" id="'+g.idBrd+'" class="item">'+g.nameBrd+" </a>")}else{$("#aside_brand_li_"+f).append('</br><span class="item_disabled">'+g.nameBrd+"</span>")}})});C.show();if(T==0){F=1}else{F=0}}else{}})}function X(){if(D==1&&K==0){U.show();return }$.post("category.do?action=list",{brandId:K},function(c){c=$.parseJSON(c);if(c.result){$("#aside_category_ul").empty();$.each(c.result.list,function(d,e){if(e.show){$("#aside_category_ul").append('<li><a href="javascript:;" class="item" id="'+e.idCat+'">'+e.nameCat+"</a></li>")}else{$("#aside_category_ul").append('<li><span class="item_disabled">'+e.nameCat+"</span></li>")}});U.show();if(K==0){D=1}else{D=0}}else{}})}}A()});